{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport { ServerEventsContext } from \"./ServerEventsProvider\";\nexport const useServerEvents = () => {\n  _s();\n  //const [subscriberID, setSubscriberID] = useState<number>(0);\n  const [eventData, setEventData] = useState();\n\n  //const formatEvent = `@sse-lib/${eventType}`\n\n  const eventSource = useContext(ServerEventsContext);\n  console.log(eventSource);\n  //console.log('eventSource -> useContext: ', eventSource)\n\n  if (!eventSource) {\n    throw new Error(`To use \"useServerEvents()\" wrap your application in provider:\n        <ServerEventsProvider>\n          <YourApp />\n        </ServerEventsProvider>\n    `);\n  }\n  const unsubscribe = () => {};\n  useEffect(() => {\n    eventSource.addEventListener(\"message\", event => {\n      console.log(\"eventSource.onmessage: \", event);\n      const data = JSON.parse(event.data);\n      setEventData(data);\n    });\n    return () => {\n      //unsubscribe();\n    };\n  }, []);\n  return {\n    data: eventData,\n    unsubscribe\n  };\n};\n_s(useServerEvents, \"crW7YfC0cy2+AF/lG/MG7LCRH3U=\");","map":{"version":3,"names":["useContext","useEffect","useState","ServerEventsContext","useServerEvents","_s","eventData","setEventData","eventSource","console","log","Error","unsubscribe","addEventListener","event","data","JSON","parse"],"sources":["/Users/kostyalbalint/Documents/fun/react-sse/react-sse-demo/src/serverEvents/useServerEvents.tsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport { ServerEventsContext } from \"./ServerEventsProvider\";\n\nexport interface ProcessingResult<T> {\n  data: T | undefined;\n  unsubscribe: () => void;\n}\n\nexport const useServerEvents = <T extends object>(): ProcessingResult<T> => {\n  //const [subscriberID, setSubscriberID] = useState<number>(0);\n  const [eventData, setEventData] = useState<T>();\n\n  //const formatEvent = `@sse-lib/${eventType}`\n\n  const eventSource = useContext(ServerEventsContext);\n  console.log(eventSource);\n  //console.log('eventSource -> useContext: ', eventSource)\n\n  if (!eventSource) {\n    throw new Error(`To use \"useServerEvents()\" wrap your application in provider:\n        <ServerEventsProvider>\n          <YourApp />\n        </ServerEventsProvider>\n    `);\n  }\n\n  const unsubscribe = () => {};\n\n  useEffect(() => {\n    eventSource.addEventListener(\"message\", (event) => {\n      console.log(\"eventSource.onmessage: \", event);\n      const data = JSON.parse(event.data);\n      setEventData(data);\n    });\n\n    return () => {\n      //unsubscribe();\n    };\n  }, []);\n\n  return {\n    data: eventData,\n    unsubscribe,\n  };\n};\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACvD,SAASC,mBAAmB,QAAQ,wBAAwB;AAO5D,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAA6C;EAAAC,EAAA;EAC1E;EACA,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGL,QAAQ,CAAI,CAAC;;EAE/C;;EAEA,MAAMM,WAAW,GAAGR,UAAU,CAACG,mBAAmB,CAAC;EACnDM,OAAO,CAACC,GAAG,CAACF,WAAW,CAAC;EACxB;;EAEA,IAAI,CAACA,WAAW,EAAE;IAChB,MAAM,IAAIG,KAAK,CAAE;AACrB;AACA;AACA;AACA,KAAK,CAAC;EACJ;EAEA,MAAMC,WAAW,GAAGA,CAAA,KAAM,CAAC,CAAC;EAE5BX,SAAS,CAAC,MAAM;IACdO,WAAW,CAACK,gBAAgB,CAAC,SAAS,EAAGC,KAAK,IAAK;MACjDL,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEI,KAAK,CAAC;MAC7C,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACC,IAAI,CAAC;MACnCR,YAAY,CAACQ,IAAI,CAAC;IACpB,CAAC,CAAC;IAEF,OAAO,MAAM;MACX;IAAA,CACD;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLA,IAAI,EAAET,SAAS;IACfM;EACF,CAAC;AACH,CAAC;AAACP,EAAA,CApCWD,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}