{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport { ServerEventsContext } from \"./ServerEventsProvider\";\nexport const useServerEvents = () => {\n  _s();\n  //const [subscriberID, setSubscriberID] = useState<number>(0);\n  const [eventData, setEventData] = useState();\n\n  //const formatEvent = `@sse-lib/${eventType}`\n\n  const eventSource = useContext(ServerEventsContext);\n  //console.log('eventSource -> useContext: ', eventSource)\n\n  if (!eventSource) {\n    throw new Error(`To use \"useServerEvents()\" wrap your application in provider:\n        <ServerEventsProvider>\n          <YourApp />\n        </ServerEventsProvider>\n    `);\n  }\n  const unsubscribe = () => eventSource.close();\n  useEffect(() => {\n    eventSource.onmessage = event => {\n      console.log(\"eventSource.onmessage: \", event);\n      const data = JSON.parse(event.data);\n      setEventData(data);\n    };\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n  return {\n    data: eventData,\n    unsubscribe\n  };\n};\n_s(useServerEvents, \"crW7YfC0cy2+AF/lG/MG7LCRH3U=\");","map":{"version":3,"names":["useContext","useEffect","useState","ServerEventsContext","useServerEvents","_s","eventData","setEventData","eventSource","Error","unsubscribe","close","onmessage","event","console","log","data","JSON","parse"],"sources":["/Users/kostyalbalint/Documents/fun/react-sse/react-sse-demo/src/serverEvents/useServerEvents.tsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport {\n  ServerEventsContext,\n  ServerEventsProvider,\n} from \"./ServerEventsProvider\";\n\nexport interface ProcessingResult<T> {\n  data: T | undefined;\n  unsubscribe: () => void;\n}\n\nexport const useServerEvents = <T extends object>(): ProcessingResult<T> => {\n  //const [subscriberID, setSubscriberID] = useState<number>(0);\n  const [eventData, setEventData] = useState<T>();\n\n  //const formatEvent = `@sse-lib/${eventType}`\n\n  const eventSource = useContext(ServerEventsContext);\n  //console.log('eventSource -> useContext: ', eventSource)\n\n  if (!eventSource) {\n    throw new Error(`To use \"useServerEvents()\" wrap your application in provider:\n        <ServerEventsProvider>\n          <YourApp />\n        </ServerEventsProvider>\n    `);\n  }\n\n  const unsubscribe = () => eventSource.close();\n\n  useEffect(() => {\n    eventSource.onmessage = (event) => {\n      console.log(\"eventSource.onmessage: \", event);\n      const data = JSON.parse(event.data);\n      setEventData(data);\n    };\n\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  return {\n    data: eventData,\n    unsubscribe,\n  };\n};\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACvD,SACEC,mBAAmB,QAEd,wBAAwB;AAO/B,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAA6C;EAAAC,EAAA;EAC1E;EACA,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGL,QAAQ,CAAI,CAAC;;EAE/C;;EAEA,MAAMM,WAAW,GAAGR,UAAU,CAACG,mBAAmB,CAAC;EACnD;;EAEA,IAAI,CAACK,WAAW,EAAE;IAChB,MAAM,IAAIC,KAAK,CAAE;AACrB;AACA;AACA;AACA,KAAK,CAAC;EACJ;EAEA,MAAMC,WAAW,GAAGA,CAAA,KAAMF,WAAW,CAACG,KAAK,CAAC,CAAC;EAE7CV,SAAS,CAAC,MAAM;IACdO,WAAW,CAACI,SAAS,GAAIC,KAAK,IAAK;MACjCC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEF,KAAK,CAAC;MAC7C,MAAMG,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACL,KAAK,CAACG,IAAI,CAAC;MACnCT,YAAY,CAACS,IAAI,CAAC;IACpB,CAAC;IAED,OAAO,MAAM;MACXN,WAAW,CAAC,CAAC;IACf,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLM,IAAI,EAAEV,SAAS;IACfI;EACF,CAAC;AACH,CAAC;AAACL,EAAA,CAnCWD,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}